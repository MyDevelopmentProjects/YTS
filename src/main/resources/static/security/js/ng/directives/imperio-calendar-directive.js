angular.module("app").directive("uiCalendar",["uiCalendarConfig",function(m){return{restrict:"A",scope:{eventSources:"=ngModel",calendarWatchEvent:"&"},controller:"uiCalendarCtrl",link:function(c,n,f,d){var p=c.eventSources,h=!1,b,k=d.changeWatcher(p,d.sourceFingerprint),l=d.changeWatcher(d.allEvents,d.eventFingerprint),g=null;c.destroy=function(){b&&b.fullCalendar&&b.fullCalendar("destroy");b=f.calendar?m.calendars[f.calendar]=$(n).html(""):$(n).html("")};c.init=function(){b.fullCalendar(g);f.calendar&&
(m.calendars[f.calendar]=b)};k.onAdded=function(a){b.fullCalendar("addEventSource",a);h=!0};k.onRemoved=function(a){b.fullCalendar("removeEventSource",a);h=!0};k.onChanged=function(a){b.fullCalendar("refetchEvents");h=!0};l.onAdded=function(a){b.fullCalendar("renderEvent",a,a.stick?!0:!1)};l.onRemoved=function(a){b.fullCalendar("removeEvents",a._id)};l.onChanged=function(a){for(var c=b.fullCalendar("clientEvents",a._id),e=0;e<c.length;e++){var d=c[e],d=angular.extend(d,a);b.fullCalendar("updateEvent",
    d)}};k.subscribe(c);l.subscribe(c,function(){if(!0===h)return h=!1});c.$watch(function(){var a=f.uiCalendar?c.$parent.$eval(f.uiCalendar):{},a=d.getFullCalendarConfig(a,m),b=d.getLocaleConfig(a);angular.extend(b,a);g={eventSources:p};angular.extend(g,b);g.calendars=null;var a={},e;for(e in g)"eventSources"!==e&&(a[e]=g[e]);return JSON.stringify(a)},function(a,b){c.destroy();c.init()})}}}]);